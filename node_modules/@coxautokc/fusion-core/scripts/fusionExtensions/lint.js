var path = require('path');
var paths = require('../../config/paths');
var chalk = require('chalk');
var fs = require('fs');

function run() {
  // The command below would normally be run in an npm script,
  // but since we want to hide all of Fusion behind an npm package, we'll run it here.
  // http://stackoverflow.com/questions/20643470/execute-a-command-line-binary-with-node-js
  var fork = require('child_process').fork;
  const lintPath = getLintPath();

  var cmd =  lintPath;

  linter = fork(cmd, ['-w']);

  process.on('exit', function() {
    linter.kill();
  });
}

function getLintPath() {
  return path.join(paths.appNodeModules, '@coxautokc', 'fusion-core', 'scripts', 'lint.js');
}

module.exports = {
  run
};
